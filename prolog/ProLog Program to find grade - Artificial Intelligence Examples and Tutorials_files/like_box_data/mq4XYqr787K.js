if (self.CavalryLogger) { CavalryLogger.start_js(["+3TjA"]); }

__d("ServiceWorkerBackgroundSyncRequest",["getAsyncHeaders","SharedClientServiceWorkerBackgroundSync","URI","ZeroRewrites"],(function(a,b,c,d,e,f){__p&&__p();function a(a,b){"use strict";this.setMethod("POST"),this.setPostData(null),this.setTag(a),this.setBgSyncID("default"),b!==undefined&&this.setURI(b)}a.prototype.queueRequest=function(){"use strict";if(this.$4===undefined)return;b("SharedClientServiceWorkerBackgroundSync").getBackgroundSyncUri(this.getURI(),this.$2,null,function(a,b){return this.$8(a,b)}.bind(this))};a.prototype.send=function(){"use strict";if(this.$4===undefined)return;b("SharedClientServiceWorkerBackgroundSync").getBackgroundSyncUri(this.getURI(),this.$2,null,function(a,b){return this.$9(a,b)}.bind(this))};a.prototype.setBgSyncID=function(a){"use strict";this.$1=a;return this};a.prototype.getBgSyncID=function(){"use strict";return this.$1};a.prototype.setMethod=function(a){"use strict";this.$3=a;return this};a.prototype.setPostData=function(a){"use strict";this.$5=a;return this};a.prototype.setTag=function(a){"use strict";this.$2=a;return this};a.prototype.getTag=function(){"use strict";return this.$2};a.prototype.setURI=function(a){"use strict";this.$4=b("ZeroRewrites").rewriteURI(new(b("URI"))(a));return this};a.prototype.getURI=function(){"use strict";return this.$4.getQualifiedURI().toString()};a.prototype.setErrorHandler=function(a){"use strict";this.$6=a;return this};a.prototype.setSuccessHandler=function(a){"use strict";this.$7=a;return this};a.prototype.$8=function(a,c){"use strict";this.setBgSyncID(c.bgSyncID);c=new Blob([this.$5],{type:"application/x-www-form-urlencoded"});c={request:{body:c,credentials:"include",headers:b("getAsyncHeaders")(new(b("URI"))(a)),method:this.$3,referrer:self.location.href,registeredTime:Date.now(),tryCount:1,url:a},bgSyncID:this.getBgSyncID()};b("SharedClientServiceWorkerBackgroundSync").queueRequest(c,this.$2)};a.prototype.$9=function(a,c){"use strict";__p&&__p();b("SharedClientServiceWorkerBackgroundSync").isBackgroundSyncAvailable()&&this.setBgSyncID(c.bgSyncID);var d=b("ZeroRewrites").getTransportBuilderForURI(this.$4)();d.open(this.$3,this.$4.toString(),!0);d.onreadystatechange=function(){if(d.readyState>=4){var a;void 0;try{a=d.status}catch(b){a=0}a===200?this.$10(d.responseText):this.$11(d.statusText)}}.bind(this);d.send(this.$5)};a.prototype.$11=function(a){"use strict";this.$6&&this.$6(a),b("SharedClientServiceWorkerBackgroundSync").isBackgroundSyncAvailable()&&b("SharedClientServiceWorkerBackgroundSync").postFailureHandler(a,this.$2)};a.prototype.$10=function(a){"use strict";this.$7&&this.$7(a),b("SharedClientServiceWorkerBackgroundSync").isBackgroundSyncAvailable()&&b("SharedClientServiceWorkerBackgroundSync").postSuccessHandler(a,this.$2,this.$1)};e.exports=a}),null);